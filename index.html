<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Html and Javascript</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notiflix@3.2.6/dist/notiflix-3.2.6.min.css"
        integrity="sha256-quZ4+TPWUyQzuPnahKf6d8Xal6tZcYZTzSt4wFVEFn8=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ladda-bootstrap/0.9.4/ladda.min.css"
        integrity="sha512-zB1n/jwQD1XiJf3rDBfZVm5xqngjw1C48MYyJ8XOd/7OLvDbjUmY9+gGyeJORcYXSv3qFOZ3VdHAoullPFHIYA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        .gradient-custom-2 {
            /* fallback for old browsers */
            background: #fccb90;
            /* Chrome 10-25, Safari 5.1-6 */
            background: -webkit-linear-gradient(to right, #ee7724, #d8363a, #dd3675, #b44593);
            /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
            background: linear-gradient(to right, #ee7724, #d8363a, #dd3675, #b44593);
        }

        @media (min-width: 768px) {
            .gradient-form {
                height: 100vh !important;
            }
        }

        @media (min-width: 769px) {
            .gradient-custom-2 {
                border-top-right-radius: .3rem;
                border-bottom-right-radius: .3rem;
            }
        }
    </style>
</head>

<body>
    <div class="h-200 gradient-form" style="background-color: #eee;">

        <section class="vh-80 " style="background-color: #eee; ">

            <div class="container py-2 h-50">
                <div class="row d-flex align-items-left h-40">
                    <div class="col-xl-22">
                        <div class="card rounded-3 text-black">
                            <div class="row g-0">

                                <div class="col-lg-4">
                                    <div class="card-body p-md-5 mx-md-4">

                                        <div class="text-center">
                                            <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/lotus.webp"
                                                style="width: 185px;" alt="logo">
                                            <!-- <h4 class="mt-1 mb-5 pb-1">Welcome My Website</h4> -->
                                        </div>

                                        <form>
                                            <h3 style="text-align:center;color:purple">Create Blog</h3>
                                            <br>
                                            <div class="form-outline mb-4">
                                                <input type="text" id="txtBlogTitle" class="form-control"
                                                    placeholder="" />
                                                <label class="form-label" for="txtBlogContent">Blog Title</label>
                                            </div>

                                            <div class="form-outline mb-4">
                                                <input type="text" id="txtBlogContent" class="form-control" />
                                                <label class="form-label" for="txtBlogContent">Blog Content</label>
                                            </div>
                                            <div class="form-outline mb-4">
                                                <input type="text" id="txtBlogAuthor" class="form-control" />
                                                <label class="form-label" for="txtBlogAuthor">Blog Author</label>
                                            </div>

                                            <div class="pt-1 mb-2 pb-1">
                                                Blog Type:
                                                <input type="checkbox" id="someCheckboxId2" name="txtType" value="R" />
                                                <label for="someCheckboxId2">Romantic</label>
                                                <input type="checkbox" id="someCheckboxId2" name="txtType" value="H" />
                                                <label for="someCheckboxId2">Haha</label><br>
                                                <input type="checkbox" style="margin-left: 77px;" id="someCheckboxId2"
                                                    name="txtType" value="D" />
                                                <label for="someCheckboxId2">Drama</label>
                                                <input type="checkbox" id="someCheckboxId2" name="txtType" value="F" />
                                                <label for="someCheckboxId2">Fiction</label><br>
                                            </div>

                                            <div class="text-center pt-1 mb-5 pb-1">
                                                <button
                                                    class="btn btn-primary ladda-button btn-block fa-lg gradient-custom-2 mb-3"
                                                    data-style="expand-left" id="btnSave" type="button">
                                                    Save
                                                </button>
                                                <button type="reset"
                                                    class="btn btn-primary ladda-button btn-block fa-lg gradient-custom-2 mb-3"
                                                    type="button">
                                                    Cancel
                                                </button>
                                                <!--<a class="text-muted" href="#!">Forgot password?</a>-->
                                            </div>

                                        </form>

                                    </div>
                                </div>
                                <div class="col-lg-8">
                                    <div class=" p-md-8 mx-md-18">
                                        <table class="table mt-4">
                                            <thead>
                                                <tr>

                                                    <th scope="col">No.</th>
                                                    <th scope="col">Blog Title</th>
                                                    <th scope="col">Blog Content</th>
                                                    <th scope="col">Blog Author</th>
                                                    <th scope="col">Blog Type</th>
                                                    <th style="width: 150px;"> Action </th>
                                                </tr>
                                            </thead>
                                            <tbody id="tbodyTest"></tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    </section>


    </div>
</body>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="https://cdn.jsdelivr.net/npm/notiflix@3.2.6/dist/notiflix-aio-3.2.6.min.js"
    integrity="sha256-pXMqYvjzxYjuQ3+Iz0Zpw3Tk3BAoet8dOsODol/iqTI=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ladda-bootstrap/0.9.4/spin.min.js"
    integrity="sha512-qByKQKO3eTwzJtP8Y395YbP45QyYZNpJfYu8jfFpWgFTK2xWIiOER7G+63EoXk475fBFzY6HIhbEUio6m72EaQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ladda-bootstrap/0.9.4/ladda.min.js"
    integrity="sha512-OxowQ96EheBKRxTivGsizVvTK8bWt2xZlymiMZ9MArbmOmuxbv+2IlC46k4gZPhZH5eVQAm0F6lk9Yt6M4xu7A=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    Notiflix.Notify.init({
        width: '280px',
        position: 'right-top',
        distance: '10px',
        opacity: 1,
        borderRadius: '5px',
        rtl: false,
        timeout: 3000,
        messageMaxLength: 110,
        backOverlay: false,
        backOverlayColor: 'rgba(0,0,0,0.5)',
        plainText: true,
        showOnlyTheLastOne: true,
        clickToClose: false,
        pauseOnHover: true,
        ID: 'NotiflixNotify',
        className: 'notiflix-notify',
        zindex: 4001,
        fontFamily: 'Quicksand',
        fontSize: '13px',
        cssAnimation: true,
        cssAnimationDuration: 400,
        cssAnimationStyle: 'fade',
        closeButton: false,
        useIcon: true,
        useFontAwesome: false,
        fontAwesomeIconStyle: 'basic',
        fontAwesomeIconSize: '34px',
        success: {
            background: '#32c682',
            textColor: '#fff',
            childClassName: 'notiflix-notify-success',
            notiflixIconColor: 'rgba(0,0,0,0.2)',
            fontAwesomeClassName: 'fas fa-check-circle',
            fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
            backOverlayColor: 'rgba(50,198,130,0.2)',
        },
        failure: {
            background: '#ff5549',
            textColor: '#fff',
            childClassName: 'notiflix-notify-failure',
            notiflixIconColor: 'rgba(0,0,0,0.2)',
            fontAwesomeClassName: 'fas fa-times-circle',
            fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
            backOverlayColor: 'rgba(255,85,73,0.2)',
        },
        warning: {
            background: '#eebf31',
            textColor: '#fff',
            childClassName: 'notiflix-notify-warning',
            notiflixIconColor: 'rgba(0,0,0,0.2)',
            fontAwesomeClassName: 'fas fa-exclamation-circle',
            fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
            backOverlayColor: 'rgba(238,191,49,0.2)',
        },
        info: {
            background: '#26c0d3',
            textColor: '#fff',
            childClassName: 'notiflix-notify-info',
            notiflixIconColor: 'rgba(0,0,0,0.2)',
            fontAwesomeClassName: 'fas fa-info-circle',
            fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
            backOverlayColor: 'rgba(38,192,211,0.2)',
        },
    });

    var editId = "";
    $("#txtBlogTitle").focus();
    loadTable();
    $('#btnSave').click(function (e) {
        e.preventDefault();
        var l = Ladda.create(this);
        l.start();

        setTimeout(() => {
            l.stop();
        }, 1000);
    })
    $("#btnSave").click(function (e) {
        var txtBlogTitle = $("#txtBlogTitle").val();
        var txtBlogContent = $("#txtBlogContent").val();
        var txtBlogAuthor = $("#txtBlogAuthor").val();

        var lst = getData();


        let inputTitle = $('#txtBlogTitle').val();

        if (inputTitle === null || inputTitle === undefined || inputTitle === '') {

            Notiflix.Notify.warning('Please Enter Blog Title', {
                position: 'center-top',
                transitionOut: 'fadeOutUp'
            });
            $("#txtBlogTitle").focus();
            return;
        }
        let inputContent = $('#txtBlogContent').val();

        if (inputContent === null || inputContent === undefined || inputContent === '') {

            Notiflix.Notify.warning('Please Enter Blog Content', {
                position: 'center-top',
                transitionOut: 'fadeOutUp'
            });
            $("#txtBlogContent").focus();
            return;
        }
        let inputAuthor = $('#txtBlogAuthor').val();

        if (inputAuthor === null || inputAuthor === undefined || inputAuthor === '') {

            Notiflix.Notify.warning('Please Enter Blog Content', {
                position: 'center-top',
                transitionOut: 'fadeOutUp'
            });
            $("#txtBlogAuthor").focus();
            return;
        }

        var BlogType = [];
        $("input[name='txtType']:checked").each(function () {
            BlogType.push($(this).val());
        });
        BlogType = BlogType.join(",");

        if (BlogType.length < 0) {
            Notiflix.Notify.warning('Please Select at least one Type', {
                position: 'center-top',
                transitionOut: 'fadeOutUp'
            });
            return;
        }



        e.preventDefault();
        var l = Ladda.create(this);
        l.start();
        const testObj = {
            Id: uuidv4(),
            BlogTitle: txtBlogTitle,
            BlogContent: txtBlogContent,
            BlogAuthor: txtBlogAuthor,
            BlogType: BlogType
        };

        setTimeout(() => {
            lst.push(testObj);
            localStorage.setItem("Tbl_Test", JSON.stringify(lst));
            clear();
            $("#txtBlogTitle").focus();
            l.stop();
            successMsg("Saving Successful.");
            loadTable();
        }, 2000);

    });

    function Edit(ele) {

        let id = $(ele).data("id");

        var lst = getData();

        const result = lst.filter(function (x) {
            return x.Id == id;
        });

        var item = result[0];
        $("#txtBlogTitle").val(item.BlogTitle);
        $("#txtBlogContent").val(item.BlogContent);
        $("#txtBlogAuthor").val(item.BlogAuthor);
        $("input[name='txtType']").prop('checked', false);
        var blogType = item.BlogType.split(',');
        blogType.forEach(function (BlogType) {
            $("input[name='txtType'][value='" + BlogType + "']").prop('checked', true);
        });

        editId = item.Id;
    }

    $("#btnUpdate").click(function () {
        if (editId === "") return;

        let inputTitle = $('#txtBlogTitle').val();
        let inputAuthor = $('#txtBlogAuthor').val();
        let inputContent = $('#txtBlogContent').val();
        if (inputTitle === null || inputTitle === undefined || inputTitle === '' ||
            inputAuthor === null || inputAuthor === undefined || inputAuthor === '' ||
            inputContent === null || inputContent === undefined || inputContent === '') {
            Notiflix.Notify.warning('Please Enter All Fields', {
                position: 'center-top',
                transitionOut: 'fadeOutUp'
            });
            return;
        }
        confirmMsg("Are you sure want to Update?").then((result) => {
            console.log(result);
            if (!result) return;
            var lst = getData();
            let index = lst.findIndex((x) => x.Id == editId);
            // let index = lst.map(e => e.Id).indexOf(id);
            console.log(`index ${index}`);

            lst[index].BlogTitle = $("#txtBlogTitle").val();
            lst[index].BlogAuthor = $("#txtBlogAuthor").val();
            lst[index].BlogContent = $("#txtBlogContent").val();

            editId = "";
            setLocal(lst);
            clear();
            loadTable();
            successMsg("Update Successful.");

            var interval1 = setInterval(() => {
                $("#txtBlogTitle").focus();
            }, 2000);
        });
    });

    function Delete(ele) {

        confirmMsg("Are you sure want to delete?").then((result) => {
            console.log(result);
            if (!result) return;
            let id = $(ele).data("id");
            var lst = getData();
            let index = lst.findIndex((x) => x.Id == id);
            lst.splice(index, 1);

            setLocal(lst);
            loadTable();
            successMsg("Deleting Successful.");
        });
    }

    function loadTable() {
        $("#tbodyTest").empty();
        var lst = getData();

        $.each(lst, function (key, value) {
            let htmlRow = `
                      <tr>
                          
                          <td>${key + 1}</td>
                          <td>${value.BlogTitle}</td>
                          <td>${value.BlogContent}</td>
                          <td>${value.BlogAuthor}</td>
                          <td>${value.BlogType}</td>
                        <td>
                              <button type="button" class="btn btn-warning" onclick="Edit(this)" data-id="${value.Id
                }">Edit</button>
                              <button type="button" class="btn btn-danger" onclick="Delete(this)" data-id="${value.Id
                }">Delete</button>
                              </td>
                      </tr>
                                      `;
            $("#tbodyTest").append(htmlRow);
        });
    }

    function uuidv4() {
        return "10000000-1000-4000-8000-100000000000".replace(/[018]/g, (c) =>
            (
                c ^
                (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))
            ).toString(16)
        );
    }


    function getData() {
        var lst = [];
        var jsonStr = localStorage.getItem("Tbl_Test");
        if (!(jsonStr === undefined || jsonStr === null || jsonStr === "")) {
            lst = JSON.parse(jsonStr);
        }
        return lst;
    }

    function setLocal(lst) {
        localStorage.setItem("Tbl_Test", JSON.stringify(lst));
    }
    function clear() {
        $("#txtBlogTitle").val("");
        $("#txtBlogAuthor").val("");
        $("#txtBlogContent").val("");
        $("#someCheckboxId2").prop('checked', false);
        $("#txtBlogTitle").focus();

    }
    function successMsg(message) {

        Notiflix.Notify.success(message, {
            position: 'center-top',
            transitionOut: 'fadeOutUp'
        });
    }

    function confirmMsg(message) {

        return new Promise(function (resolve, reject) {
            Notiflix.Confirm.show(
                "Confirm",
                message,
                "Yes",
                "No",
                function okCb() {
                    resolve(true);
                },
                function cancelCb() {
                    resolve(false);
                },
                {}
            );
        });
    }
</script>
</body>

</html>